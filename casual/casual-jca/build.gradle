//-*- coding: utf-8 -*-
plugins {
    id 'java'
    id 'jacoco'
    id 'groovy'
}

defaultTasks 'build'

group = 'se.kodarkatten.casual'
version = '0.0.1'

configurations {
    resourceAdapter
}

dependencies {
    compile project(':casual:casual-api')
    compile project(':casual:casual-internal')
    compile project(':casual:casual-network')
    compile project(':casual:casual-network-protocol')
    compile project(':casual:casual-inbound')
    compile 'io.netty:netty-all:4.1.21.Final'
    provided 'javax:javaee-api:7.0'
    resourceAdapter project(':casual:casual-api')
    resourceAdapter project(':casual:casual-internal')
    resourceAdapter project(':casual:casual-network')
    resourceAdapter project(':casual:casual-network-protocol')
    resourceAdapter project(':casual:casual-inbound-api')
    resourceAdapter 'io.netty:netty-all:4.1.21.Final'
    testCompile 'junit:junit:4.8.2+'
    testCompile 'org.hamcrest:hamcrest-all:1.3'
    // for spock
    testCompile 'org.codehaus.groovy:groovy-all:2.4.4+'
    testCompile 'org.spockframework:spock-core:1.0-groovy-2.4'
    testCompile 'cglib:cglib-nodep:3.2.4'
    testCompile 'org.objenesis:objenesis:1.2'

    //Integration test.
    integrationCompile project(':casual:casual-fielded-annotations')
    integrationCompile files('../../../casual-java-testapp/test-api/build/libs/test-api.jar')

    integrationCompile "commons-io:commons-io:2.4"
}

task rar(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Casual Resource Adapter with XA', 'Implementation-Version': '1.0', 'Specification-Version': '1.0'
    }
    extension = 'rar'
    into('') {
        from jar
    }
    into('') {
        from configurations.resourceAdapter
    }
    into('') {
        from sourceSets.main.resources
    }
}

artifacts.add( "resourceAdapter", rar )
